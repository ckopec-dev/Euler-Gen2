# Euler Problem 234 Solution in Visual Basic

```vb
Module Problem234
    Sub Main()
        Dim limit As Long = 999966663333
        Dim sum As Long = 0
        Dim i As Long = 1
        
        ' Find all semidivisible numbers up to the limit
        While i * i <= limit
            Dim p As Long = i * i
            Dim q As Long = (i + 1) * (i + 1)
            
            ' Check if p is a perfect square and q is a perfect square
            ' But we want semidivisible numbers which are between consecutive perfect squares
            
            ' For each perfect square p = i², we need to find numbers between p and q-1
            ' that are divisible by exactly one of the prime factors of p
            
            ' Find the prime factors of p
            Dim factors As List(Of Long) = GetPrimeFactors(p)
            
            ' Check numbers between p and q-1 for semidivisibility
            For j As Long = p + 1 To q - 1
                If IsSemidivisible(j, factors) Then
                    sum += j
                End If
            Next
            
            i += 1
        End While
        
        Console.WriteLine("Sum of semidivisible numbers: " & sum)
        Console.ReadKey()
    End Sub
    
    Function GetPrimeFactors(n As Long) As List(Of Long)
        Dim factors As New List(Of Long)
        Dim d As Long = 2
        
        While d * d <= n
            While n Mod d = 0
                If Not factors.Contains(d) Then
                    factors.Add(d)
                End If
                n = n \ d
            End While
            d += 1
        End While
        
        If n > 1 AndAlso Not factors.Contains(n) Then
            factors.Add(n)
        End If
        
        Return factors
    End Function
    
    Function IsSemidivisible(n As Long, factors As List(Of Long)) As Boolean
        Dim divisibleCount As Integer = 0
        
        For Each factor As Long In factors
            If n Mod factor = 0 Then
                divisibleCount += 1
            End If
        Next
        
        ' A semidivisible number is divisible by exactly one of its prime factors
        Return divisibleCount = 1
    End Function
End Module
```

Wait, let me reconsider this problem. Looking at Euler Problem 234 more carefully:

```vb
Module Problem234
    Sub Main()
        Dim limit As Long = 999966663333
        Dim sum As Long = 0
        
        ' For each pair of consecutive perfect squares
        Dim i As Long = 1
        Dim p As Long = 1
        Dim q As Long = 4
        
        While q <= limit
            ' Find semidivisible numbers between p and q-1
            Dim tempSum As Long = 0
            
            ' Find all numbers between p and q-1 that are semidivisible
            For num As Long = p + 1 To q - 1
                If IsSemidivisible(num, p, q) Then
                    sum += num
                End If
            Next
            
            i += 1
            p = i * i
            q = (i + 1) * (i + 1)
        End While
        
        Console.WriteLine("Sum of semidivisible numbers: " & sum)
        Console.ReadKey()
    End Sub
    
    Function IsSemidivisible(n As Long, p As Long, q As Long) As Boolean
        ' A number n is semidivisible if it is divisible by exactly one of 
        ' the prime factors of the perfect squares p and q
        Dim pFactors As List(Of Long) = GetPrimeFactors(p)
        Dim qFactors As List(Of Long) = GetPrimeFactors(q)
        
        ' Combine all prime factors
        Dim allFactors As New List(Of Long)
        allFactors.AddRange(pFactors)
        allFactors.AddRange(qFactors)
        
        ' Remove duplicates
        Dim uniqueFactors As New HashSet(Of Long)(allFactors)
        
        Dim divisibleCount As Integer = 0
        
        For Each factor As Long In uniqueFactors
            If n Mod factor = 0 Then
                divisibleCount += 1
            End If
        Next
        
        ' Semidivisible means divisible by exactly one prime factor
        Return divisibleCount = 1
    End Function
    
    Function GetPrimeFactors(n As Long) As List(Of Long)
        Dim factors As New List(Of Long)
        Dim d As Long = 2
        
        While d * d <= n
            While n Mod d = 0
                factors.Add(d)
                n = n \ d
            End While
            d += 1
        End While
        
        If n > 1 Then
            factors.Add(n)
        End If
        
        Return factors
    End Function
End Module
```

Actually, let me re-read Euler Problem 234. The correct interpretation is:

```vb
Module Problem234
    Sub Main()
        Dim limit As Long = 999966663333
        Dim sum As Long = 0
        
        ' Find semidivisible numbers
        Dim i As Long = 1
        Dim p As Long = 1
        Dim q As Long = 4
        
        While q <= limit
            ' Check all numbers between p and q-1 for semidivisibility
            For num As Long = p + 1 To q - 1
                If IsSemidivisible(num, p, q) Then
                    sum += num
                End If
            Next
            
            i += 1
            p = i * i
            q = (i + 1) * (i + 1)
        End While
        
        Console.WriteLine("Sum of semidivisible numbers: " & sum)
        Console.ReadKey()
    End Sub
    
    Function IsSemidivisible(n As Long, p As Long, q As Long) As Boolean
        ' For consecutive perfect squares p = i² and q = (i+1)²
        ' A number n is semidivisible if it is divisible by exactly one of:
        ' 1. The smallest prime factor of p
        ' 2. The largest prime factor of q
        
        Dim pFactors As List(Of Long) = GetPrimeFactors(p)
        Dim qFactors As List(Of Long) = GetPrimeFactors(q)
        
        Dim smallestP As Long = pFactors(0)
        Dim largestQ As Long = qFactors(qFactors.Count - 1)
        
        Dim divisibleCount As Integer = 0
        
        If n Mod smallestP = 0 Then
            divisibleCount += 1
        End If
        
        If n Mod largestQ = 0 Then
            divisibleCount += 1
        End If
        
        ' Semidivisible means divisible by exactly one of them
        Return divisibleCount = 1
    End Function
    
    Function GetPrimeFactors(n As Long) As List(Of Long)
        Dim factors As New List(Of Long)
        Dim d As Long = 2
        
        While d * d <= n
            While n Mod d = 0
                factors.Add(d)
                n = n \ d
            End While
            d += 1
        End While
        
        If n > 1 Then
            factors.Add(n)
        End If
        
        Return factors
    End Function
End Module
```

