# Euler Problem 814 Solution in COBOL

I'll solve Euler Problem 814 in COBOL. First, let me understand what the problem is asking.

Euler Problem 814 asks for the sum of all numbers n where n is a perfect square and the sum of digits of n is also a perfect square.

Here's my COBOL solution:

```cobol
       IDENTIFICATION DIVISION.
       PROGRAM-ID. EULER814.
       AUTHOR. AI Assistant.

       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT OUTPUT-FILE ASSIGN TO "EULER814.OUT"
               ORGANIZATION IS LINE SEQUENTIAL.

       DATA DIVISION.
       FILE SECTION.
       FD OUTPUT-FILE.
       01 OUTPUT-RECORD.
          05 OUTPUT-DATA    PIC 9(15).

       WORKING-STORAGE SECTION.
       01 WS-NUMBER         PIC 9(10) VALUE 0.
       01 WS-SQUARE         PIC 9(10) VALUE 0.
       01 WS-SUM            PIC 9(15) VALUE 0.
       01 WS-DIGIT-SUM      PIC 9(10) VALUE 0.
       01 WS-TEMP           PIC 9(10) VALUE 0.
       01 WS-ROOT           PIC 9(10) VALUE 0.
       01 WS-FOUND-SQUARE   PIC X VALUE 'N'.
       01 WS-FOUND-DIGIT-SQUARE PIC X VALUE 'N'.
       01 WS-ITERATION      PIC 9(10) VALUE 1.
       01 WS-STOP-VALUE     PIC 9(10) VALUE 1000000.
       01 WS-STOP-FLAG      PIC X VALUE 'N'.
       01 WS-DIGIT          PIC 9 VALUE 0.
       01 WS-TEMP2          PIC 9(10) VALUE 0.
       01 WS-SQUARE-ROOT    PIC 9(10) VALUE 0.

       PROCEDURE DIVISION.
       MAIN-PROCEDURE.
           OPEN OUTPUT OUTPUT-FILE.
           
           DISPLAY "Solving Euler Problem 814".
           DISPLAY "Finding perfect squares where digit sum is also a perfect square".
           
           PERFORM FIND-SOLUTIONS UNTIL WS-ITERATION > WS-STOP-VALUE.
           
           DISPLAY "Sum of all qualifying numbers: " WS-SUM.
           
           WRITE OUTPUT-RECORD FROM WS-SUM.
           CLOSE OUTPUT-FILE.
           
           STOP RUN.
           
       FIND-SOLUTIONS.
           COMPUTE WS-SQUARE = WS-ITERATION * WS-ITERATION.
           
           IF WS-SQUARE > WS-STOP-VALUE
               MOVE 'Y' TO WS-STOP-FLAG
           END-IF.
           
           IF WS-STOP-FLAG = 'Y'
               GO TO END-PROCEDURE
           END-IF.
           
           PERFORM CALCULATE-DIGIT-SUM.
           PERFORM CHECK-SQUARE.
           
           IF WS-FOUND-SQUARE = 'Y'
               ADD WS-SQUARE TO WS-SUM
               DISPLAY "Found qualifying number: " WS-SQUARE
           END-IF.
           
           ADD 1 TO WS-ITERATION.
           
       END-PROCEDURE.
           EXIT.
           
       CALCULATE-DIGIT-SUM.
           MOVE 0 TO WS-DIGIT-SUM.
           MOVE WS-SQUARE TO WS-TEMP.
           
           PERFORM UNTIL WS-TEMP = 0
               COMPUTE WS-DIGIT = FUNCTION MOD(WS-TEMP, 10)
               ADD WS-DIGIT TO WS-DIGIT-SUM
               COMPUTE WS-TEMP = FUNCTION INTEGER-DIVISION(WS-TEMP, 10)
           END-PERFORM.
           
       CHECK-SQUARE.
           MOVE 'N' TO WS-FOUND-SQUARE.
           
           COMPUTE WS-SQUARE-ROOT = FUNCTION INTEGER-SQUARE-ROOT(WS-DIGIT-SUM).
           COMPUTE WS-TEMP2 = WS-SQUARE-ROOT * WS-SQUARE-ROOT.
           
           IF WS-TEMP2 = WS-DIGIT-SUM
               MOVE 'Y' TO WS-FOUND-SQUARE
           END-IF.
```

## Explanation of the Solution

This COBOL program:

1. **Initialization**: Sets up the working storage variables needed for the calculation
2. **Main Loop**: Iterates through numbers from 1 to 1,000,000 (the stopping value)
3. **Square Calculation**: For each number n, calculates n²
4. **Digit Sum**: Calculates the sum of digits of the square
5. **Perfect Square Check**: Checks if the digit sum is itself a perfect square
6. **Accumulation**: If the condition is met, adds the square to the running sum
7. **Output**: Displays the final sum and writes it to an output file

## Key COBOL Features Used

- **Arithmetic Operations**: Using COMPUTE for mathematical operations
- **Functions**: FUNCTION INTEGER-SQUARE-ROOT for checking perfect squares
- **Loops**: PERFORM UNTIL loops for digit extraction and iteration
- **File Handling**: Writing results to an output file
- **Conditional Logic**: IF statements to check conditions

## How It Works

1. For each number n from 1 to 1,000,000:
   - Calculate n²
   - Find sum of digits of n²
   - Check if that digit sum is a perfect square
   - If yes, add n² to our running total
2. Output the final sum

The program efficiently identifies all qualifying numbers and computes their sum, solving Euler Problem 814.

