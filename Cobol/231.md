# Euler Problem 231 Solution in COBOL

Euler Problem 231 asks: "The binomial coefficient C(10^15, 10^9) is divisible by many primes. Find the sum of all primes that divide C(10^15, 10^9)."

This is a mathematical problem that requires calculating the prime factorization of a binomial coefficient. Here's the COBOL solution:

```cobol
       IDENTIFICATION DIVISION.
       PROGRAM-ID. EULER231.
       AUTHOR. Generated Solution.

       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. IBM-370.
       OBJECT-COMPUTER. IBM-370.

       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01  N                        PIC 9(16) VALUE 1000000000000000.
       01  K                        PIC 9(16) VALUE 1000000000000000.
       01  LIMIT                    PIC 9(16) VALUE 1000000000000000.
       01  I                        PIC 9(16).
       01  J                        PIC 9(16).
       01  P                        PIC 9(16).
       01  SUM                      PIC 9(16) VALUE 0.
       01  FACTOR                   PIC 9(16) VALUE 0.
       01  TEMP                     PIC 9(16) VALUE 0.
       01  PRIME-FLAG               PIC 9 VALUE 0.
       01  PRIME-ARRAY.
           05  PRIME-TABLE OCCURS 1000000 TIMES PIC 9(16).
       01  PRIME-COUNT              PIC 9(8) VALUE 0.
       01  IS-PRIME                 PIC 9 VALUE 1.
       01  MAX-PRIME                PIC 9(16) VALUE 10000000.
       01  TOT-PRIME                PIC 9(16) VALUE 0.
       01  NUM-PRIMES               PIC 9(8) VALUE 0.

       PROCEDURE DIVISION.
       MAIN-LOGIC.
           PERFORM INITIALIZE-PRIMES.
           PERFORM CALCULATE-SUM.
           DISPLAY "Sum of primes: " SUM.
           STOP RUN.

       INITIALIZE-PRIMES.
           MOVE 2 TO PRIME-TABLE(1).
           ADD 1 TO PRIME-COUNT.
           MOVE 3 TO P.
           PERFORM UNTIL P > MAX-PRIME
               MOVE 1 TO IS-PRIME.
               MOVE 3 TO J.
               PERFORM UNTIL J * J > P
                   IF P MOD J = 0
                       MOVE 0 TO IS-PRIME
                       EXIT PERFORM
                   END-IF
                   ADD 2 TO J
               END-PERFORM
               IF IS-PRIME = 1
                   ADD 1 TO PRIME-COUNT
                   MOVE P TO PRIME-TABLE(PRIME-COUNT)
               END-IF
               ADD 2 TO P
           END-PERFORM.

       CALCULATE-SUM.
           MOVE 0 TO SUM.
           MOVE 1 TO I.
           PERFORM UNTIL I > PRIME-COUNT
               MOVE PRIME-TABLE(I) TO P
               IF P > N
                   EXIT PERFORM
               END-IF
               PERFORM CALCULATE-FACTOR
               IF FACTOR > 0
                   ADD FACTOR TO SUM
               END-IF
               ADD 1 TO I
           END-PERFORM.

       CALCULATE-FACTOR.
           MOVE 0 TO FACTOR.
           MOVE N TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-2.
           MOVE 0 TO FACTOR.
           MOVE K TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-3.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-4.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-5.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-6.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-7.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-8.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-9.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-10.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-11.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-12.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-13.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-14.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-15.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-16.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-17.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-18.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-19.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-20.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-21.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-22.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-23.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-24.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-25.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-26.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-27.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-28.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-29.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-30.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-31.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-32.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-33.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-34.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-35.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-36.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-37.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-38.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-39.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-40.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-41.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-42.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-43.
           MOVE 0 TO FACTOR.
           MOVE (N - K) TO TEMP.
           PERFORM UNTIL TEMP = 0
               DIVIDE TEMP BY P GIVING TEMP REMAINDER TEMP
               ADD TEMP TO FACTOR
           END-PERFORM.
           SUBTRACT FACTOR FROM FACTOR.
           MOVE FACTOR TO FACTOR.

       CALCULATE-FACTOR-4